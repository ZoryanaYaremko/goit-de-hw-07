# GoIT Homework 07 - Apache Airflow
У рамках завдання було реалізовано DAG hw_medals_zoryana в Apache Airflow, який моделює обробку та перевірку даних про медалі.

Основна логіка DAG:

1. Створення таблиці
За допомогою MySqlOperator створюється таблиця zoryana_hw07_results, де будуть зберігатися результати.

2. Випадковий вибір типу медалі
PythonOperator обирає випадковий тип медалі (Gold / Silver / Bronze).

3. Розгалуження сценарію (Branching)
Використовується BranchPythonOperator, який направляє виконання до відповідного кроку: calc_gold, calc_silver або calc_bronze.

4. Обчислення кількості медалей
Три різні задачі (MySqlOperator) вставляють запис із підрахунком у таблицю, залежно від обраного типу медалі.

5. Затримка виконання
PythonOperator виконує штучну затримку (10 секунд), щоб змоделювати асинхронність процесів.
Використано TriggerRule.ONE_SUCCESS, щоб крок виконувався навіть у випадку, якщо лише одна з попередніх задач завершилася успішно.

6. Перевірка свіжості даних (Sensor)
SqlSensor перевіряє, чи є в таблиці новий запис не старший за 30 секунд.

7. Фінальна перевірка
Остання задача check_table вибирає дані з таблиці для підтвердження результатів.

Тестування результатів
1. DAG успішно запускався в інтерфейсі Airflow, що підтверджують скріншоти.
2. Було перевірено логіку вставки даних у таблицю за допомогою DBeaver:
- Вибір останніх записів.
- Перевірка кількості медалей за типами (GROUP BY).
- Вибір максимальних значень для кожного типу.

Висновок
1. DAG реалізує повний ETL-процес: створення таблиці → вибір та обчислення → затримка → сенсор перевірки → вибірка результатів.
2. Усі задачі налаштовані правильно, DAG працює стабільно.
3. Отримані результати успішно підтверджено в DBeaver SQL-запитами.

Screenshots:
screenshot1.png – DAG hw_medals_zoryana відображається в інтерфейсі Airflow (стартовий вигляд).
screenshot2.png – Перша візуалізація графа DAG після запуску (створення таблиці, початкові кроки).
screenshot3.png – Виконання DAG із відображенням виконаних та пропущених задач.
screenshot4.png – Проміжний стан DAG із підсвіткою виконаних кроків.
screenshot5.png – DAG після кількох ітерацій із відображенням затримки (delay) і сенсора.
screenshot6.png – DAG у стані з успішними та пропущеними задачами, включно із check_recent_insert.
screenshot7.png – Логи виконання задачі check_table в інтерфейсі Airflow.
screenshot8.png – Запит у DBeaver: відображення даних із таблиці zoryana_hw07_results (10 останніх рядків).
screenshot9.png – DBeaver: вибір 5 останніх записів із таблиці zoryana_hw07_results.
screenshot10.png – DBeaver: агрегація результатів за типом медалей (GROUP BY medal_type).
screenshot11.png – DBeaver: пошук максимальних значень count для кожного типу медалей (MAX(count) GROUP BY medal_type).

